# ML System Design Doc - [RU]

> ## Термины и пояснения
> - Итерация - это все работы, которые совершаются до старта очередного пилота
> - БТ - бизнес-требования
> - EDA - Exploratory Data Analysis - исследовательский анализ данных
> - `Product Owner`,  `Data Scientist` - роли, которые заполняют соответствующие разделы
> - В этом шаблоне роль `Data Scientist` совмещает в себе компетенции классического `Data Scientist` с упором на исследования и `ML Engineer` & `ML Ops` роли с акцентом на продуктивизацию моделей
> - Для вашей организации распределение ролей может быть уточнено в зависимости от операционной модели

### 1. Цели и предпосылки

#### 1.1. Зачем идем в разработку продукта?

- **Бизнес-цель**: Разработать веб-сервис для прогнозирования зарплаты на основе множества факторов (например, опыт, регион, навыки).

  **Retention**: Благодаря функционалу прогнозирования зарплаты пользователи будут возвращаться к сервису для уточнения данных и получения рекомендаций, что способствует увеличению retention. Соискатели могут регулярно проверять, как изменения в их опыте или навыках могут повлиять на зарплатные ожидания, а работодатели — на актуальность своих предложений.

  **Conversion**: Увеличение точности зарплатных прогнозов позволяет точнее настроить ожидания соискателей и работодателей, что приводит к большему числу успешных трудовых сделок. Это может повысить конверсии и улучшить взаимодействие между платформой и ее пользователями.

- **Почему это улучшит текущую ситуацию?**: Важно предоставить пользователям инструмент для более точного прогнозирования зарплат на основе данных с HH.ru и других открытых источников. Это будет полезно как для соискателей, так и для работодателей.

- **Что считаем успехом итерации?**: Успешная итерация будет означать создание работающего прототипа веб-сервиса с прогнозами зарплат, доступных для пользователей, а также демонстрация точности модели с целевой метрикой MAPE в пределах 10-15% от реальной зарплаты (в зависимости от вакансии и доступных данных) с использованием реальных данных.

#### 1.2. Бизнес-требования и ограничения

#### Бизнес-требования:
- **Прогнозирование зарплаты** на основе параметров, таких как опыт, регион, навыки, образование и тип занятости.
- **Интерактивный веб-сервис**, где пользователи могут вводить свои параметры и получать прогнозы по зарплатам.
- **Механизм оценки влияния факторов**: предоставление пользователю информации о том, как каждый фактор (опыт, регион, навыки) влияет на итоговый прогноз и их относительная значимость.
- **Использование данных HH.ru** и других открытых данных для повышения точности прогнозов.

#### Бизнес-ограничения:

- **Точность прогнозов**: Обычно для задач прогнозирования, таких как зарплата, показатель MAPE в пределах 10-20% может считаться достаточным для большинства бизнес-приложений.

- **Время обучения модели**: С учетом всех этапов разработки (сбор данных, обучение модели, настройка, разработка веб-сервиса, пилотное тестирование), разумный срок для завершения итерации разработки модели и запуска в эксплуатацию — это от 6 до 8 недель. В зависимости от сложности задачи и ресурсов, этот срок может варьироваться.

- **Конфиденциальность данных**: Все данные будут собраны из открытых источников и обработаны в соответствии с требованиями GDPR. Личные данные будут анонимизированы или обезличены. Применяются меры безопасности, включая шифрование и регулярные аудиты для защиты данных. Пользователи будут информированы о целях использования данных и смогут дать согласие на их обработку.

#### 1.3. Что входит в скоуп проекта/итерации, что не входит

#### Входит в скоуп проекта:
- Сбор и очистка данных с **HH.ru** и других источников.
- Разработка прогностической модели для предсказания зарплат.
- Разработка веб-интерфейса для пользователей, позволяющего выбирать параметры и получать прогнозы.
- Реализация механизма для отображения влияния факторов на прогноз.

#### Не входит в скоуп проекта:
- Персонализированные данные для конкретных пользователей.
- Детализированные отчеты для конкретных компаний или кандидатов.
- Прогнозирование карьерного роста или других факторов, не связанных с зарплатой.

#### Результат с точки зрения качества:
- Модель с низкой ошибкой прогнозирования в пределах 10-15% MAPE. Это обеспечит достаточную точность для практического использования, позволяя пользователям получать достоверные прогнозы зарплаты. Модель будет оцениваться на реальных данных, и точность прогнозов будет проверяться в различных сценариях для подтверждения её надежности.

- Удобный интерфейс для пользователей, подтвержденный через тестирование UX/UI и обратную связь от целевых пользователей. Удобство будет измеряться через метрики, такие как время на выполнение задачи, уровень удовлетворенности пользователей и коэффициент удержания.

- Демонстрация значимости факторов (опыт, регион, навыки) для прогнозируемых зарплат.

#### 1.4. Предпосылки решения

- **Используемые данные**: данные с **HH.ru** (зарплаты, вакансии, требования) и другие открытые источники (экономические данные).
- **Модели машинного обучения**: использование моделей, таких как линейная регрессия / обобщенные регрессионные модели / деревья решений / градиентный бустинг для построения наилучшей прогностической модели.
- **Ограничения**: модель будет зависеть от доступности и качества данных на момент обучения.

### 2. Методология `Data Scientist`

#### 2.1. Постановка задачи

- **Тип задачи (Data Science)**: Задача регрессии (Supervised Learning) - модель будет обучаться на исторических данных для прогнозирования зарплаты пользователя, основываясь на таких факторах, как регион, опыт работы, квалификация и другие. Цель — создать модель с ошибкой предсказания в пределах 10-15% MAPE, что будет обеспечивать достаточную точность для практического использования.

- **Цель Data Science**: Разработать регрессионную модель, которая обучается на данных о зарплатах, учитывая параметры, такие как опыт, навыки и регион. Ожидаемое качество модели — минимизация ошибки предсказания (в пределах 10-15% MAPE) и повышение точности прогнозов для пользователей. Модель будет оптимизирована для достижения наилучших результатов через корректировку гиперпараметров и выбор наиболее релевантных признаков.

- **Цель Backend**: создание сервиса с поддержкой базы данных, который будет принимать запросы от пользователей, обрабатывать введённые данные (например, через API), передавать их в модель для получения прогноза и возвращать результат. Также необходимо реализовать систему хранения данных (например, о пользователях, их запросах и предсказаниях), а также интерфейсы для взаимодействия с моделью и фронтендом.

- **Цель Frontend**: реализовать веб-интерфейс, который будет позволять пользователям вводить свои данные (регион, опыт работы, навыки и другие параметры) и получать прогнозируемую зарплату. Интерфейс должен быть интуитивно понятным и удобным для пользователя, с возможностью отображения полученного прогноза и рекомендаций по улучшению зарплаты (если такие будут предусмотрены моделью).

- **Цель UX/UI**: создание удобного и эстетически приятного пользовательского интерфейса, который будет учитывать потребности целевой аудитории. Важно обеспечить лёгкость в использовании, хорошую визуализацию данных и быструю реакцию интерфейса на действия пользователя.

#### 2.2. Блок-схема решения

![alt text](schema.png)

#### 2.3. Этапы решения задачи `Data Scientist`

#### Этап 1 и 2: Сбор и подготовка данных

- **Данные и сущности**:
  | Название данных  | Источник данных | Роль для получения данных | Проверено ли качество данных |
  | ------------- | ------------- | ------------- | ------------- |
  | Вакансии и зарплаты | HH.ru | Data Engineer, Data Scientist | Да |
  | Экономические данные | Открытые источники | Data Scientist | Да |

- **Краткое описание результата**: подготовленные данные для обучения модели прогнозирования зарплат.

#### Этап 3: Разработка прогностической модели
- **Метод**: используем регрессию или деревья решений для построения модели, прогнозирующей зарплату на основе факторов (опыт, регион, навыки).
- **Результат**: модель с прогнозом заработной платы.

#### Этап 4: Оценка значимости факторов
- **Метод**: анализ важности признаков с помощью методов интерпретации моделей (например, SHAP или LIME).
- **Результат**: вывод о том, какие факторы оказывают наибольшее влияние на прогнозируемую зарплату.

#### Этап 5: Разработка веб-интерфейса
- **Функциональность**: создание простого интерфейса, позволяющего пользователю вводить данные и получать прогноз.
- **Результат**: работающий веб-сервис.

#### Этап 6: Тестирование модели
- **Метод**: тестирование на новых данных для оптимизации точности модели.
- **Результат**: улучшенная модель, готовая к развертыванию.

## 3. Подготовка пилота

### 3.1. Способ оценки пилота
- Краткое описание дизайна пилота: запуск пилотного проекта с реальными пользователями для оценки точности модели и удовлетворенности пользователей.

### 3.2. Что считаем успешным пилотом
- Успех пилота заключается в достижении точности модели, соответствующей бизнес-целям, и положительных отзывах пользователей.

### 3.3. Подготовка пилота
- Ожидаемая вычислительная сложность будет определяться на этапе тестирования. Планируем провести тесты с ограничениями по вычислительным мощностям.

## 4. Внедрение для production систем

### 4.1. Архитектура решения
- Архитектура включает в себя веб-сервис, модель прогнозирования, базу данных с результатами и API для взаимодействия с системой.

### 4.2. Описание инфраструктуры и масштабируемости
- Мы используем облачные ресурсы для хостинга модели и веб-сервиса, что обеспечит масштабируемость и отказоустойчивость системы.

### 4.3. Требования к работе системы
- SLA для ответа на запросы пользователей: Время отклика на запрос пользователя не должно превышать 5-7 секунд при уровне запросов не более X RPS (например, 50 или 100 запросов в секунду), где X — оптимальный показатель для ожидаемой нагрузки системы. При превышении этого порога, возможна оптимизация, например, с использованием кэширования, масштабирования инфраструктуры или оптимизации работы модели.

### 4.4. Безопасность системы
- В системе предусмотрены меры для защиты данных пользователей и защиты от атак.

### 4.5. Безопасность данных
- Все данные обрабатываются в соответствии с требованиями GDPR и других норм по защите данных.

### 4.6. Издержки
- Ожидаемые издержки будут включать расходы на серверы и хранение данных, которые будут уточнены на этапе пилота.

### 4.7. Риски
- Риски включают возможное недооцененное влияние некоторых факторов на точность модели, что будет проверяться в процессе пилотирования.
